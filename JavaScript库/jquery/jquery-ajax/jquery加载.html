<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>AJAX加载</title>
    <script type="text/javascript" src="js/jquery-1.8.3.js"></script>
</head>

<body>

    <h3 id='test'>请点击下面的按钮，通过jQuery Ajax改变这段文本</h3>
    <button type="button" id='btn'>获得外部内容</button>

    <!-- <h3 id='test1'>请点击下面的按钮，通过jQuery Ajax改变这段文本</h3>
    <button type="button" id='btn1'>获得服务端内容</button> -->

    
    <div id="div1">
        <h2>使用 jQuery AJAX 来改变文本</h2>
    </div>
    <button id="btn2">获得外部内容</button>


    <div id="div2">
        <h2>使用 jQuery AJAX 来改变文本</h2>
    </div>
    <button id="btn3">获得外部内容</button>
    
    
    <script>
        
        // 关于 jQuery 与 AJAX  
        // jQuery 提供多个与 AJAX 有关的方法。
        // 通过 jQuery AJAX 方法，您能够使用 HTTP Get 和 HTTP Post 从远程服务器上请求文本、HTML、XML 或 JSON - 同时您能够把这些外部数据直接载入网页的被选元素中。
        // 提示：如果没有 jQuery，AJAX 编程还是有些难度的。

        // 编写常规的 AJAX 代码并不容易，因为不同的浏览器对 AJAX 的实现并不相同。这意味着您必须编写额外的代码对浏览器进行测试。不过，jQuery 团队为我们解决了这个难题，我们只需要一行简单的代码，就可以实现 AJAX功能。
        

        //一、jQuery - AJAX load() 方法
        //1.jQuery load() 方法
        //load() 方法从服务器加载数据，并把返回的数据放入被选元素中。
        //语法：
        // $(selector).load(URL,data,callback);
        
        // selector:被选元素的选择器，$(selector)就是选中元素
        // 必需的 URL 参数规定您希望加载的 URL。
        // 可选的 data 参数规定与请求一同发送的查询字符串键/值对集合。
        // 可选的 callback 参数是 load() 方法完成后所执行的函数名称

        $('#btn').click(function(){
            $('#test').load('file/demo_test.txt'); 
            //将demo_test.txt内容嵌到<h1></h1>中，把原来的文本覆盖
        });

        // $('#btn1').click(function(){
        //     $('#test1').load('http://127.0.0.1:8080/Servlet-demo4/checkUser.action','username:tom'); 
        // });

        //把 jQuery 选择器添加到 URL 参数。
        // 下面的例子把 "demo_test.txt" 文件中 id="p1" 的元素的内容，加载到指定的 <div> 元素中：
        $('#btn2').click(function(){
            $('#div1').load('file/demo_test.txt #p1'); 
            //将demo_test.txt的id="p1" 的元素的内容加载到div中，覆盖原本的h2>使用 jQuery AJAX来改变文本</h2>
        });

        //可选的 callback 参数规定当 load() 方法完成后所要允许的回调函数。回调函数可以设置不同的参数：
        // esponseTxt - 包含调用成功时的结果内容
        // statusTXT - 包含调用的状态
        // xhr - 包含 XMLHttpRequest 对象

        $('#btn3').click(function(){
            $('#div2').load('file/demo_test.txt',function(responseTxt,statusTxt,xhr){
                if(statusTxt == 'success'){
                    alert(xhr.status+' '+xhr.statusTxt); //200 undefined
                    alert('外部内容加载成功！');
                }else if(statusTxt == 'error'){
                    alert(xhr.status+' '+xhr.statusTxt); //404 undefined
                    alert('外部内容加载失败！');
                }    
            }); 
        });
    </script>
</body>

</html>
